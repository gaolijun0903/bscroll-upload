<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8"/>
		<meta https-equiv="Content-Type" content="text/html; charset=utf-8" />
	    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no, initial-scale=1">
	    <meta name = "format-detection" content = "telephone=no"><!--防止iOS网页中的数字被识别为电话号码-->
		<meta name="screen-orientation" content="portrait"><!-- uc强制竖屏 -->
		<meta name="x5-orientation" content="portrait"><!-- QQ强制竖屏 -->
		<title>上拉加载</title>
		
		<style type="text/css">
		 * { padding:0; margin:0;-webkit-tap-highlight-color: rgba(0,0,0,0); box-sizing: border-box;}
		HTML ,body { font-size:12px;height:100%;width:100%; font-family: "Microsoft YaHei", "Hiragino Sans GB", "WenQuanYi Micro Hei", sans-serif;}
		li { list-style-type:none;}
		body{background-color: #1a0059;}
		.wrapper{ width: 10.0rem;min-height: 100%; background-image: url(img/bgrow.png);}
		
		.lucky-list{ position: relative; /*padding-bottom: 1.5rem;*/ }
		.lucky-list .lucky-title{ width: 10.0rem; height: 3.72rem; }
		.lucky-list .lucky-bg{ margin: -1.65rem auto 0; width: 8.946667rem; padding: 1.75rem 0.233333rem 0.233333rem 0.233333rem; height: 13.7rem; border: 0.04rem solid #02c4fb; }
		.lucky-list .lucky-bg .lucky-body{ height: 11.55rem; overflow: hidden; /*importent*/}
		.lucky-list .list-item{ height: 1.226667rem; margin-bottom: 0.206667rem; background: #152577; color: #02c4fb; }
		.lucky-list .list-item .cell{ display: inline-block; line-height: 1.226667rem; text-align: center; font-size: 0.373333rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
		.lucky-list .list-item .name{ width:2.16rem; }
		.lucky-list .list-item .tel{ width:3.2rem; }
		.lucky-list .list-item .prize{ width:2.25rem; color: #baeb4e;}
		.lucky-list .lucky-bg .list-body-no{line-height: 8rem; color: #fff; text-align: center; font-size: 0.4rem;}
		
		.loading-hook{color:#fff;text-align: center;}
		</style>
	</head>
	<body>
		<div id="app">
			<div class="wrapper">
				<div class="lucky-list">
					<div class="lucky-title">
						<img src="img/lucky-list-bg.png" width="100%" height="100%"/>
					</div>
					<div class="lucky-bg">
						<div class="lucky-body" ref="listWrapper">
							<div>
								<div id="list-body" ref="listBody" class="list-body" v-show="luckyList.length>0">
									<div class="list-item" v-for="item in luckyList">
										<div class="cell name" v-html="item.name"></div>
										<div class="cell tel" v-html="item.cellphone"></div>
										<div class="cell prize" v-html="toPrize(item.award_type)"></div>
									</div>
								</div>
								<div class="loading-hook" v-html="bottomTip"></div>
								<div class="list-body-no" v-show="luckyList.length===0">中奖名单将会在这里展现</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<script src="js/vue.min.js"></script>
        <script src="js/jsonp.js"></script>
		<script src="js/bscroll.min.js"></script>	
		
		<script type="text/javascript" src="js/flexible.js"></script>	
	<script type="text/javascript">
	
	new Vue({
	  el: '#app',
	  data:{
	  	bottomTip:"上拉查看更多",
		luckyList:[ // 获奖司机列表
	            {
	                "name": "test",
	                "cellphone": 18810605345,
	                "award_type":0
	            },
	            {
	                "name": "测试测试测试测试测试2",
	                "cellphone": 13312345678,
	                "award_type":1
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":2
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":3
	            },
	             {
	                "name": "测试测试测试测试测试2",
	                "cellphone": 13312345678,
	                "award_type":1
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":2
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":3
	            },
	            {
	                "name": "测试测试测试测试测试2",
	                "cellphone": 13312345678,
	                "award_type":1
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":2
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":3
	            },
	             {
	                "name": "测试测试测试测试测试2",
	                "cellphone": 13312345678,
	                "award_type":1
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":2
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":3
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":4
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":5
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":2
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":3
	            },
	             {
	                "name": "测试测试测试测试测试2",
	                "cellphone": 13312345678,
	                "award_type":1
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":2
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":3
	            },
	            {
	                "name": "测试测试测试测试测试2",
	                "cellphone": 13312345678,
	                "award_type":1
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":2
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":2
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":3
	            },
	             {
	                "name": "测试测试测试测试测试2",
	                "cellphone": 13312345678,
	                "award_type":1
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":2
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":3
	            },
	            {
	                "name": "测试测试测试测试测试2",
	                "cellphone": 13312345678,
	                "award_type":1
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":2
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":2
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":3
	            },
	             {
	                "name": "测试测试测试测试测试2",
	                "cellphone": 13312345678,
	                "award_type":1
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":2
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":3
	            },
	            {
	                "name": "测试测试测试测试测试2",
	                "cellphone": 13312345678,
	                "award_type":1
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":2
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":2
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":3
	            },
	             {
	                "name": "测试测试测试测试测试2",
	                "cellphone": 13312345678,
	                "award_type":1
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":2
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":3
	            },
	            {
	                "name": "测试测试测试测试测试2",
	                "cellphone": 13312345678,
	                "award_type":1
	            },
	            {
	                "name": "测试2",
	                "cellphone": 13312345678,
	                "award_type":2
	            }
	        ],
		currentPage:1
	  },
	  mounted: function(){
	  	this.initScroll();
	
	  },
	  methods:{
		initScroll:function () {
			var vm = this;
			if(this.scroll){
	  			this.scroll.refresh();
	  			return 
	  		}
			vm.scroll = new BScroll(this.$refs.listWrapper, {
				probeType: 1
			});
			
			vm.scroll.on('touchEnd', function (position) {
				console.log("touchEnd")
			    if(position.y < (this.maxScrollY - 30)) {
			      vm.bottomTip = '加载中...';
			      setTimeout(function () {
			        // 恢复文本值 
			        vm.bottomTip = '上拉查看更多';
			        // 向列表添加数据
			        vm.reloadData();
			        // 加载更多后,重新计算滚动区域高度
			        vm.scroll.refresh();
			      }, 1000);
			    }
			});
		},
		reloadData:function () {// 加载更多方法
		  var newItemArr= [{
	              "name": "newnew",
	              "cellphone": 18810605345,
	              "award_type":0
	          },{
	              "name": "newnew",
	              "cellphone": 18810605345,
	              "award_type":0
	          },{
	              "name": "newnew",
	              "cellphone": 18810605345,
	              "award_type":0
	          },{
	              "name": "newnew",
	              "cellphone": 18810605345,
	              "award_type":0
	          },{
	              "name": "newnew",
	              "cellphone": 18810605345,
	              "award_type":0
	          },{
	              "name": "newnew",
	              "cellphone": 18810605345,
	              "award_type":0
	          },{
	              "name": "newnew",
	              "cellphone": 18810605345,
	              "award_type":0
	          },{
	              "name": "newnew",
	              "cellphone": 18810605345,
	              "award_type":0
	          },{
	              "name": "newnew",
	              "cellphone": 18810605345,
	              "award_type":0
	          },{
	              "name": "newnew",
	              "cellphone": 18810605345,
	              "award_type":0
	          }];
	
			this.luckyList = this.luckyList.concat(newItemArr);
			
		  	/*JSONP.init({
	  			error:function(ex){
	  				alert("Failed to load:" + ex.url);
	  			}
	  		})
			JSONP.get("http://.../getCurrentPage?page="+this.currentPage+"&pageCount=20", function (data) {
	   			if(data.code==200){
	   				if(data.result.driverList.length<20){
	   					vm.bottomTip = '已经到底了';
	   				}else{
	   					vm.currentPage++;
	   				}
	         		vm.luckyList = vm.luckyList.concat(data.result.driverList);
	            }else{
	            	vm.toastMsgFn(data.code);
	            }
	 		});*/
		},
		toPrize:function(num){
			if(num===0){
				return "100元";
			}else if(num==1){
				return "500元 ";
			}else if(num==2){
				return "1000元";
			}else if(num==3){
				return "华为手机";
			}else{
				return "凯美瑞汽车 ";
			}
		}
	 }
	})
	
	</script>
	</body>
</html>
